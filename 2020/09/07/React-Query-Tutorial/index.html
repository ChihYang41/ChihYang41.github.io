<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>React Query Tutorial - Chih Yang&#39;s Blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">




<meta name="description" content="Chih Yang 的前端小天地">



<meta name="keywords" content="前端">



    <meta name="description" content="&amp;#x524D;&amp;#x8A00;data fetching &amp;#x5728; React &amp;#x88E1;&amp;#x4E00;&amp;#x76F4;&amp;#x662F;&amp;#x6211;&amp;#x611F;&amp;#x5230;&amp;#x4E0D;&amp;#x592A;&amp;#x81EA;&amp;#x5728;&amp;#x7684;&amp;#x4E00;&amp;#x584A;&amp;#xFF0C;&amp;#x4E3B;&amp;#x8981;&amp;#x662F;&amp;#x4F86;&amp;#x">
<meta property="og:type" content="article">
<meta property="og:title" content="React Query Tutorial">
<meta property="og:url" content="https://chihyang41.github.io/2020/09/07/React-Query-Tutorial/index.html">
<meta property="og:site_name" content="Chih Yang&#39;s Blog">
<meta property="og:description" content="&amp;#x524D;&amp;#x8A00;data fetching &amp;#x5728; React &amp;#x88E1;&amp;#x4E00;&amp;#x76F4;&amp;#x662F;&amp;#x6211;&amp;#x611F;&amp;#x5230;&amp;#x4E0D;&amp;#x592A;&amp;#x81EA;&amp;#x5728;&amp;#x7684;&amp;#x4E00;&amp;#x584A;&amp;#xFF0C;&amp;#x4E3B;&amp;#x8981;&amp;#x662F;&amp;#x4F86;&amp;#x">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlgy1gift4o0wk1j31m00u078k.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlgy1giha9kf5brj31gi0u0tgv.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlgy1gihabcdeeej31gi0u0gtl.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlgy1gihbw2bgddg30nw0hghdt.gif">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlgy1gihczyiibeg30nw0hgqv5.gif">
<meta property="article:published_time" content="2020-09-06T16:34:24.000Z">
<meta property="article:modified_time" content="2020-09-07T13:12:00.932Z">
<meta property="article:author" content="Chih Yang">
<meta property="article:tag" content="React">
<meta property="article:tag" content="Front-End">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/007S8ZIlgy1gift4o0wk1j31m00u078k.jpg">





<link rel="icon" href="https://upload.cc/i1/2020/03/05/MXS6WH.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css">


<link rel="stylesheet" href="/css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146838618-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-146838618-1');
</script>


    


<meta name="generator" content="Hexo 4.2.0"></head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    Chih Yang&#39;s Blog
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">Archives</a>
            
            <a class="navbar-item "
               href="/tags">Tags</a>
            
            <a class="navbar-item "
               href="/categories">Categories</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="Search" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
            <a class="navbar-item" title="GitHub" href="https://github.com/ChihYang41" target="_blank" rel="noopener">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            React Query Tutorial
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2020-09-06T16:34:24.000Z" itemprop="datePublished">Sep 7 2020</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/frontend/">frontend</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            26 minutes read (About 3914 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <html><head></head><body><h2 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h2><p>data fetching &#x5728; React &#x88E1;&#x4E00;&#x76F4;&#x662F;&#x6211;&#x611F;&#x5230;&#x4E0D;&#x592A;&#x81EA;&#x5728;&#x7684;&#x4E00;&#x584A;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x4F86;&#x81EA;&#x65BC;&#x6211;&#x5B78;&#x85DD;&#x4E0D;&#x7CBE;&#xFF0C;&#x6211;&#x77E5;&#x9053; React &#x5DF2;&#x7D93;&#x6709;&#x90E8;&#x5206;&#x7684; pattern &#x5728;&#x8655;&#x7406;&#x9019;&#x4E00;&#x584A;&#x4E86;&#xFF0C;&#x76EE;&#x524D;&#x6700;&#x5E38;&#x7528;&#x5230;&#x7684;&#x5C31;&#x662F; Redux + Redux middlewares&#xFF08;Redux thunk&#x3001;Redux saga &#x7B49;&#x7B49;&#xFF09;&#xFF0C;&#x524D;&#x9663;&#x5B50;&#x5247;&#x662F;&#x958B;&#x59CB;&#x8A66;&#x8457;&#x7528; custom hook &#x4F86;&#x8655;&#x7406;&#x9019;&#x584A;&#xFF0C;&#x611F;&#x89BA;&#x5F88;&#x4E0D;&#x8CF4;&#xFF0C;&#x4F46;&#x6BD4;&#x5982; cache &#x7B49;&#x7B49;&#x7684;&#x4E8B;&#x60C5;&#x4F9D;&#x7136;&#x9EBB;&#x7169;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5728;&#x5C0B;&#x627E;&#x6709;&#x6C92;&#x6709;&#x66F4;&#x597D;&#x7684;&#x4F5C;&#x6CD5;&#x3002;</p>
<p>&#x6700;&#x8FD1;&#x770B;&#x5230;&#x4E86; React Query&#xFF0C;&#x4F7F;&#x7528;&#x8D77;&#x4F86;&#x89BA;&#x5F97;&#x5F88;&#x8B9A;&#x8B9A;&#xFF0C;&#x6587;&#x4EF6;&#x8AAA;&#x660E;&#x6E05;&#x695A;&#x3001;API &#x5C11;&#x5C11;&#x7684;&#x5F88;&#x7C21;&#x55AE;&#xFF0C;&#x5F88;&#x7B26;&#x5408;&#x6211;&#x5FC3;&#x76EE;&#x4E2D;&#x597D;&#x7528;&#x7684; data fetching hook&#xFF0C;&#x4E0D;&#x904E;&#x76EE;&#x524D;&#x4E5F;&#x6C92;&#x6709;&#x7528;&#x5F88;&#x6DF1;&#xFF0C;&#x66F4;&#x591A;&#x7684;&#x5751;&#x6216;&#x662F;&#x61C9;&#x7528;&#x5834;&#x666F;&#x9084;&#x6C92;&#x6709;&#x9047;&#x5230;&#xFF0C;&#x6240;&#x4EE5;&#x4F7F;&#x7528;&#x5FC3;&#x5F97;&#x53EF;&#x80FD;&#x9084;&#x8981;&#x518D;&#x4E00;&#x9663;&#x5B50;&#x624D;&#x6703;&#x6709;&#xFF0C;&#x9019;&#x7BC7;&#x7684;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x505A;&#x505A;&#x7B46;&#x8A18;&#xFF0C;&#x63D0;&#x4F9B;&#x65E5;&#x5F8C;&#x7684;&#x81EA;&#x5DF1;&#x56DE;&#x9867;&#x3002;</p>
<a id="more"></a>

<h2 id="&#x1F449;-&#x70BA;&#x4F55;&#x8981;&#x4F7F;&#x7528;&#xFF1F;&#x5982;&#x679C;&#x4E0D;&#x7528;&#x5B83;&#x6703;&#x600E;&#x9EBC;&#x6A23;&#xFF1F;"><a href="#&#x1F449;-&#x70BA;&#x4F55;&#x8981;&#x4F7F;&#x7528;&#xFF1F;&#x5982;&#x679C;&#x4E0D;&#x7528;&#x5B83;&#x6703;&#x600E;&#x9EBC;&#x6A23;&#xFF1F;" class="headerlink" title="&#x1F449; &#x70BA;&#x4F55;&#x8981;&#x4F7F;&#x7528;&#xFF1F;&#x5982;&#x679C;&#x4E0D;&#x7528;&#x5B83;&#x6703;&#x600E;&#x9EBC;&#x6A23;&#xFF1F;"></a>&#x1F449; &#x70BA;&#x4F55;&#x8981;&#x4F7F;&#x7528;&#xFF1F;&#x5982;&#x679C;&#x4E0D;&#x7528;&#x5B83;&#x6703;&#x600E;&#x9EBC;&#x6A23;&#xFF1F;</h2><p>&#x5982;&#x679C;&#x4F7F;&#x7528; Redux &#x4E00;&#x6BB5;&#x6642;&#x9593;&#x5F8C;&#xFF0C;&#x61C9;&#x8A72;&#x6703;&#x767C;&#x73FE; Global State &#x5927;&#x81F4;&#x4E0A;&#x53EF;&#x4EE5;&#x5206;&#x6210;&#x5169;&#x7A2E;&#x985E;&#x578B;&#xFF0C;&#x4E00;&#x7A2E;&#x662F;&#x95DC;&#x65BC;&#x6574;&#x500B; Web App &#x7684;&#x5167;&#x90E8;&#x72C0;&#x614B;&#xFF0C;&#x6BD4;&#x5982; toggle&#x3001;alert&#xFF0C;&#x9019;&#x985E;&#x72C0;&#x614B;&#x4E0D;&#x9700;&#x8981; cache&#xFF0C;&#x53C8;&#x6216;&#x662F;&#x5176;&#x4ED6;&#x7684;&#x8655;&#x7406;&#xFF1B;&#x53E6;&#x4E00;&#x7A2E;&#x5247;&#x662F;&#x9700;&#x8981;&#x7D93;&#x904E;&#x975E;&#x540C;&#x6B65;&#x7372;&#x53D6;&#x7684;&#x8CC7;&#x6599;&#xFF0C;&#x50CF;&#x662F; call API &#x624D;&#x80FD;&#x62FF;&#x5230;&#x7684; data&#x3001;&#x767B;&#x5165;&#x7684; token &#x7B49;&#x7B49;&#x3002;</p>
<p>&#x539F;&#x672C; Redux &#x7684;&#x793E;&#x7FA4;&#x70BA;&#x4E86;&#x8655;&#x7406;&#x9019;&#x985E;&#x975E;&#x540C;&#x6B65;&#x7684; state&#xFF0C;&#x8A95;&#x751F;&#x4E86;&#x50CF;&#x662F; redux-thunk&#x3001;redux-saga&#x3001;redux-observable &#x7B49; middlewares &#x4F86;&#x8655;&#x7406;&#x76F8;&#x95DC;&#x908F;&#x8F2F;&#xFF0C;&#x70BA;&#x7684;&#x662F;&#x8B93;&#x908F;&#x8F2F;&#x5206;&#x5DE5;&#x66F4;&#x70BA;&#x660E;&#x78BA;&#xFF0C;&#x638C;&#x7BA1; View &#x7684; Component &#x5C31;&#x8CA0;&#x8CAC;&#x986F;&#x793A;&#x756B;&#x9762;&#xFF0C;call API &#x908F;&#x8F2F;&#x5C31;&#x5728; middlewares &#x4E2D;&#x8655;&#x7406;&#xFF0C;&#x4F46;&#x6642;&#x9593;&#x4E00;&#x4E45;&#x4F60;&#x9084;&#x662F;&#x6703;&#x767C;&#x73FE; reducers &#x4E2D;&#x5206;&#x6563;&#x4E86;&#x5404;&#x985E;&#x7684; state&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x540C;&#x6B65;&#x7684; state &#x548C;&#x975E;&#x540C;&#x6B65;&#x7684; state &#x6DF7;&#x96DC;&#x518D;&#x4E00;&#x8D77;&#x3002;</p>
<p>React Query &#x5C31;&#x662F;&#x56E0;&#x61C9;&#x800C;&#x751F;&#x7684;&#xFF0C;&#x4F5C;&#x8005;&#x5C07; global state &#x5340;&#x5206;&#x70BA; Client state &#x548C; Server State&#xFF0C;Client state &#x5C31;&#x662F;&#x524D;&#x9762;&#x6BB5;&#x843D;&#x8AAA;&#x7684; Web App &#x5167;&#x90E8;&#x72C0;&#x614B;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4FDD;&#x8B49;&#x4ED6;&#x6703;&#x662F;&#x6700;&#x65B0;&#x7684;&#x72C0;&#x614B;&#xFF0C;&#x800C; client state &#x8655;&#x7406;&#x8D77;&#x4F86;&#x4E5F;&#x76F8;&#x5C0D;&#x7C21;&#x55AE;&#xFF1B;Server State &#x5247;&#x662F;&#x9700;&#x8981;&#x7D93;&#x904E;&#x975E;&#x540C;&#x6B65;&#x7372;&#x53D6;&#x7684; state&#xFF0C;&#x50CF;&#x662F; call API &#x5F97;&#x5230;&#x7684; data&#xFF0C;&#x4F60;&#x7121;&#x6CD5;&#x4FDD;&#x8B49;&#x4ED6;&#x662F;&#x6700;&#x65B0;&#x7684;&#xFF0C;&#x4E26;&#x4E14;&#x5E38;&#x5E38;&#x9700;&#x8981;&#x7D93;&#x904E;&#x6BD4;&#x8F03;&#x8907;&#x96DC;&#x7684;&#x8655;&#x7406;&#xFF0C;&#x6BD4;&#x5982; cache&#x3001;&#x91CD;&#x65B0; fetch&#x3001;&#x6291;&#x6216;&#x662F; background updating &#x7B49;&#x7B49;&#x7684;&#xFF0C;&#x800C; React Query <strong>&#x5C31;&#x662F;&#x70BA;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x8655;&#x7406; Server State</strong> &#x800C;&#x51FA;&#x73FE;&#x3002;</p>
<p>&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;React Query &#x548C; Redux &#x4E0D;&#x662F;&#x4E8C;&#x9078;&#x4E00;&#x7684;&#x9078;&#x9805;&#xFF0C;&#x800C;&#x662F;&#x53EF;&#x4EE5;&#x5171;&#x5B58;&#x7684;&#xFF0C;&#x5982;&#x540C;&#x4F5C;&#x8005; Tanner Linsey &#x5728; <a href="https://www.reddit.com/r/reactjs/comments/ds0hp4/react_query_hooks_for_fetching_caching_and/" target="_blank" rel="noopener">reddit</a> &#x6240;&#x8A00;&#xFF1A;</p>
<blockquote>
<p>React Query is significantly different from using Redux. Redux is a global state manager with it&#x2019;s own context etc. React Query to some extent is also a global state manager for async data. If you were to integrate the two, you would move all of your async data out of redux into React Query and only use Redux for non-async-data global application state.</p>
</blockquote>
<p>&#x4F5C;&#x8005; Tanner Linsey &#x8AAA;&#x5230;&#x4ED6;&#x5728;&#x958B;&#x767C; <a href="https://nozzle.io/" target="_blank" rel="noopener">Nozzle.io</a> &#x7684;&#x904E;&#x6E21;&#x6642;&#x671F;&#x5C31;&#x662F;&#x63A1;&#x7528;&#x9019;&#x6A23;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x800C;&#x5728;&#x6700;&#x5F8C; Redux &#x4E5F;&#x88AB;&#x62D4;&#x6389;&#x4E86;&#xFF0C;&#x800C;&#x662F;&#x6539;&#x7528; <code>useReducer</code> + React Context &#x4F86;&#x7BA1;&#x7406; global UI state&#x3002;</p>
<p>&#x5982;&#x679C;&#x89BA;&#x5F97;&#x539F;&#x672C;&#x7684; Redux + Redux middleware &#x751F;&#x614B;&#x7CFB;&#x4F7F;&#x7528;&#x7684;&#x5F88;&#x597D;&#xFF0C;&#x5C08;&#x6848;&#x908F;&#x8F2F;&#x67B6;&#x69CB;&#x883B;&#x6E05;&#x6670;&#x7684;&#xFF0C;&#x4E5F;&#x6709;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#x8655;&#x7406; cache&#x3001;&#x91CD;&#x65B0; fetch &#x9019;&#x985E;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x90A3;&#x4E0D;&#x4F7F;&#x7528;&#x7576;&#x7136;&#x4E5F;&#x6C92;&#x554F;&#x984C;&#xFF1B;&#x4E0D;&#x904E; React Query &#x662F;&#x4E00;&#x500B;&#x65B0;&#x7684;&#x9078;&#x64C7;&#xFF0C;&#x8B93;&#x4F60;&#x7528;&#x7C21;&#x55AE;&#x7684;&#x5E7E;&#x500B; API  &#x5C31;&#x80FD;&#x5920;&#x7C21;&#x55AE;&#x5C0D;&#x4ED8;&#x9EBB;&#x7169;&#x7684; cache &#x4EE5;&#x53CA;&#x66F4;&#x597D;&#x7684;&#x7BA1;&#x7406; Server State&#xFF0C;&#x5982;&#x679C;&#x6709;&#x8208;&#x8DA3;&#x7684;&#x8A71;&#xFF0C;&#x53EF;&#x4EE5;&#x7D66;&#x5B83;&#x500B;&#x6A5F;&#x6703;&#x8A66;&#x8A66;&#xFF08;&#x8207; React Query &#x7528;&#x9014;&#x76F8;&#x4F3C;&#x7684;&#x9084;&#x6709; <a href="https://github.com/vercel/swr" target="_blank" rel="noopener">React SWR</a> &#x4EE5;&#x53CA; GraphQL &#x7684; <a href="https://github.com/apollographql/apollo-client" target="_blank" rel="noopener">Apollo Client</a>&#xFF09;</p>
<p>&#x53E6;&#x5916;&#xFF0C;&#x6709;&#x8208;&#x8DA3;&#x7684;&#x8A71;&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#x4F5C;&#x8005;&#x7684; <a href="https://www.youtube.com/watch?v=seU46c6Jz7E&amp;feature=emb_title" target="_blank" rel="noopener">&#x5F71;&#x7247;&#x4ECB;&#x7D39;</a> &#xFF0C;&#x9019;&#x90E8;&#x5F71;&#x7247;&#x628A; React Query &#x8A95;&#x751F;&#x7684;&#x76EE;&#x7684;&#x8B1B;&#x89E3;&#x975E;&#x5E38;&#x6E05;&#x695A;&#xFF0C;&#x540C;&#x6642;&#x4E5F;&#x7528;&#x4E86; React Query &#x91CD;&#x69CB;&#x5C0F;&#x5C08;&#x6848;&#xFF0C;&#x8B93;&#x958B;&#x767C;&#x8005;&#x5011;&#x80FD;&#x5920;&#x770B;&#x770B;&#x91CD;&#x69CB;&#x524D;&#x5F8C;&#x7684;&#x5DEE;&#x7570;&#xFF08;&#x96D6;&#x7136;&#x6211;&#x89BA;&#x5F97;&#x5F71;&#x7247;&#x4E2D;&#x7684;&#x87A2;&#x5E55;&#x592A;&#x5C0F;&#x4E86;&#xFF0C;&#x5F88;&#x96E3;&#x770B;&#x6E05;&#x695A; code&#xFF09;</p>
<h2 id="&#x1F449;-Getting-Started"><a href="#&#x1F449;-Getting-Started" class="headerlink" title="&#x1F449; Getting Started"></a>&#x1F449; Getting Started</h2><p>&#x63A5;&#x4E0B;&#x4F86;&#x60F3;&#x7528; <a href="https://swapi.dev/" target="_blank" rel="noopener">Star Wars API</a> &#x5EFA;&#x7ACB;&#x7684;&#x7C21;&#x55AE; project &#x4F86;&#x4ECB;&#x7D39; React Query &#x7684;&#x5404;&#x500B; API&#xFF0C;&#x9019;&#x908A;&#x6709;&#x5EFA;&#x597D;&#x7684; <a href="https://codesandbox.io/s/blissful-poincare-vxqv8?file=/src/App.js" target="_blank" rel="noopener">codesandbox template</a></p>
<h3 id="&#x958B;&#x59CB;&#x524D;&#x7684;&#x9808;&#x77E5;-React-Query-&#x7684;&#x9810;&#x8A2D;&#x884C;&#x70BA;"><a href="#&#x958B;&#x59CB;&#x524D;&#x7684;&#x9808;&#x77E5;-React-Query-&#x7684;&#x9810;&#x8A2D;&#x884C;&#x70BA;" class="headerlink" title="&#x958B;&#x59CB;&#x524D;&#x7684;&#x9808;&#x77E5; - React Query &#x7684;&#x9810;&#x8A2D;&#x884C;&#x70BA;"></a>&#x958B;&#x59CB;&#x524D;&#x7684;&#x9808;&#x77E5; - React Query &#x7684;&#x9810;&#x8A2D;&#x884C;&#x70BA;</h3><ol>
<li>Query results &#x6E32;&#x67D3;&#x5728;&#x756B;&#x9762;&#x4E0A;&#x7684;&#x7D50;&#x679C;&#x6703;&#x5728;&#x4ED6;&#x5011;&#x88AB; resolved &#x5F8C;&#x99AC;&#x4E0A;&#x904E;&#x671F;&#xFF0C;&#x4E26;&#x4E14;&#x7576;&#x7D50;&#x679C;&#x518D;&#x6B21;&#x88AB; render &#x6216;&#x662F;&#x88AB;&#x4F7F;&#x7528;&#x6642;&#xFF0C;&#x6703;&#x81EA;&#x52D5;&#x5728;&#x80CC;&#x666F; refetch&#xFF0C;&#x4E26;&#x4E14;&#x958B;&#x767C;&#x8005;&#x4E5F;&#x53EF;&#x4EE5;&#x6539;&#x8B8A; <code>staleTime</code> &#x9019;&#x500B;&#x8A2D;&#x5B9A;&#x4F86;&#x8ABF;&#x6574;&#x904E;&#x671F;&#x7684;&#x6642;&#x9593;&#xFF08;&#x9810;&#x8A2D;&#x70BA; <code>0</code> milliseconds&#xFF09;&#x3002;</li>
<li>Query results &#x5728; Component unmounted &#x5F8C;&#x4ECD;&#x7136;&#x6703;&#x88AB; cached&#xFF0C;garbage collected &#x9810;&#x8A2D;&#x7684;&#x6642;&#x9593;&#x70BA;&#x4E94;&#x5206;&#x9418;&#xFF0C;&#x5047;&#x5982;&#x9019;&#x4E94;&#x5206;&#x9418;&#x518D;&#x6B21;&#x88AB;&#x4F7F;&#x7528;&#x5230;&#x7684;&#x8A71;&#xFF0C;&#x5C31;&#x6703;&#x5F9E; cached &#x53D6;&#x51FA;&#x9019;&#x4E9B; results &#x4F7F;&#x7528;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x66F4;&#x6539;&#x9810;&#x8A2D;&#x503C;&#x7684;&#x8A71;&#xFF0C;&#x53EF;&#x4EE5;&#x5F9E; <code>cacheTime</code> &#x4F86;&#x505A;&#x8ABF;&#x6574;&#xFF08;&#x9810;&#x8A2D;&#x70BA; <code>1000 * 60 * 5</code> milliseconds&#xFF09;&#x3002;</li>
<li>Stale queries &#x6703;&#x5728;&#x4F7F;&#x7528;&#x8005; refocus &#x700F;&#x89BD;&#x5668;&#x7684; window &#x6216;&#x662F;&#x700F;&#x89BD;&#x5668;&#x91CD;&#x65B0;&#x9023;&#x7DDA;&#x6642; refetch&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x60F3;&#x6709;&#x9019;&#x4E9B;&#x884C;&#x70BA;&#x7684;&#x8A71;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5F9E; <code>refetchOnWindowFocus</code> &#x548C; <code>refetchOnReconnect</code> &#x9019;&#x5169;&#x500B;&#x9078;&#x9805;&#x4F86;&#x505A;&#x8ABF;&#x6574;</li>
<li>Queries &#x5982;&#x679C;&#x5931;&#x6557;&#x7684;&#x8A71;&#xFF0C;&#x6703; retried &#x4E09;&#x6B21;&#xFF0C;&#x7576;&#x4E09;&#x6B21;&#x90FD;&#x5931;&#x6557;&#x7684;&#x6642;&#x5019; status &#x624D;&#x6703;&#x986F;&#x793A; error&#xFF0C;&#x5982;&#x679C;&#x8981;&#x66F4;&#x6539;&#x9019;&#x985E;&#x8A2D;&#x5B9A;&#x7684;&#x8A71;&#xFF0C;&#x53EF;&#x4EE5;&#x5F9E; <code>retry</code> &#x548C; <code>retryDelay</code> &#x4F86;&#x8ABF;&#x6574;&#x3002;</li>
<li>Query results &#x5728;&#x9810;&#x8A2D;&#x60C5;&#x6CC1;&#x4E0B;&#x6703;&#x662F; structurally shared &#x7684;&#xFF0C;&#x4EE5;&#x6AA2;&#x6E2C; data &#x662F;&#x5426;&#x6709;&#x66F4;&#x6539;&#xFF0C;&#x5982;&#x679C;&#x6C92;&#x6709;&#x7684;&#x8A71;&#xFF0C;references &#x5C31;&#x6703;&#x4FDD;&#x6301;&#x4E0D;&#x8B8A;&#xFF0C;&#x4EE5;&#x4FDD;&#x8B49; <code>useCallback</code> &#x548C; <code>useMemo</code> value &#x7684;&#x7A69;&#x5B9A;&#x3002;structurally shared &#x53EA;&#x5C0D; JSON-compatible values &#x6709;&#x4F5C;&#x7528;&#xFF0C;&#x5176;&#x4ED6;&#x7684; value types &#x90FD;&#x6703;&#x88AB;&#x8996;&#x70BA;&#x6709;&#x8B8A;&#x5316;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x767C;&#x73FE;&#x6548;&#x80FD;&#x4E0A;&#x7684;&#x554F;&#x984C;&#x4F86;&#x81EA;&#x65BC;&#x592A;&#x9F90;&#x5927;&#x7684; response&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x628A; <code>config.structuralSharing</code> &#x9019;&#x500B;&#x9078;&#x9805;&#x7D66; disabled&#xFF0C;&#x90A3;&#x5982;&#x679C;&#x4F60;&#x5728;&#x8655;&#x7406; non-JSON compatible values &#x7684;&#x8A71;&#xFF0C;&#x4ECD;&#x7136;&#x60F3;&#x76E3;&#x6E2C; data &#x662F;&#x5426;&#x6709;&#x8B8A;&#x5316;&#x7684;&#x8A71;&#xFF0C;&#x53EF;&#x4EE5;&#x5F9E; <code>config.isDataEqual</code> &#x505A;&#x66F4;&#x5BA2;&#x88FD;&#x5316;&#x7684;&#x8A2D;&#x5B9A;&#x3002;</li>
</ol>
<h3 id="useQuery"><a href="#useQuery" class="headerlink" title="useQuery"></a>useQuery</h3><p>&#x9996;&#x5148;&#x4ECB;&#x7D39;&#x7B2C;&#x4E00;&#x500B; API&#xFF0C;<code>useQuery</code>&#xFF0C;&#x76EE;&#x524D;&#x6211;&#x5011;&#x6709;&#x5E7E;&#x500B; component&#xFF0C;<code>App.jsx</code>&#x3001;<code>Navbar.jsx</code>&#x3001;<code>Planets.jsx</code> &#x548C; <code>People.jsx</code> &#x9019;&#x5E7E;&#x500B; Component&#xFF0C;&#x6211;&#x5011;&#x7684;&#x4E3B;&#x89D2;&#x5C31;&#x662F; <code>Planets.jsx</code>&#x3001;<code>People.jsx</code>&#xFF0C;&#x5176;&#x4ED6;&#x4E0D;&#x91CD;&#x8981;&#xFF0C;<code>Navbar.jsx</code> &#x5C31;&#x662F;&#x7528;&#x4F86;&#x5207;&#x63DB; Planets &#x548C; People &#x7528;&#x7684;&#x5C0E;&#x89BD;&#x5217;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x4F86;&#xFF0C;&#x6211;&#x5011;&#x5148;&#x5230; <code>Planets.jsx</code> &#x9019;&#x652F;&#x6A94;&#x6848;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4EE5;&#x4E0B;&#xFF1A;</p>
<p></p><figure class="highlight jsx hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Planets</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">  <span class="hljs-keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;Planets&lt;<span class="hljs-regexp">/h2&gt;</span></span><br><span class="line"><span class="hljs-regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6BEB;&#x7121;&#x53CD;&#x61C9;&#xFF0C;&#x5C31;&#x662F;&#x4E00;&#x652F;&#x7121;&#x804A;&#x7684; Component&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x4F86;&#x8A2D;&#x5B9A;&#x4E00;&#x4E0B;&#x73FE;&#x5728;&#x7684;&#x9996;&#x8981;&#x4EFB;&#x52D9;&#x76EE;&#x6A19;&#xFF0C;&#x4EE5;&#x53CA;&#x9810;&#x8A08;&#x5982;&#x4F55;&#x57F7;&#x884C;&#xFF1A;</p>
<h4 id="&#x26F3;&#xFE0F;-&#x4EFB;&#x52D9;&#x76EE;&#x6A19;"><a href="#&#x26F3;&#xFE0F;-&#x4EFB;&#x52D9;&#x76EE;&#x6A19;" class="headerlink" title="&#x26F3;&#xFE0F; &#x4EFB;&#x52D9;&#x76EE;&#x6A19;"></a>&#x26F3;&#xFE0F; &#x4EFB;&#x52D9;&#x76EE;&#x6A19;</h4><p>&#x767C; request &#x5F9E; <code>&apos;https://swapi.dev/api/planets/&apos;</code> &#x9019;&#x500B; endpoint &#x53D6;&#x5F97; response &#x5F8C;&#xFF0C;&#x628A;&#x5404;&#x500B;&#x661F;&#x7403;&#x7684;&#x8CC7;&#x6599; render &#x5230;&#x756B;&#x9762;&#x4E0A;&#x3002;</p>
<h4 id="&#x26F3;&#xFE0F;-&#x5982;&#x4F55;&#x57F7;&#x884C;"><a href="#&#x26F3;&#xFE0F;-&#x5982;&#x4F55;&#x57F7;&#x884C;" class="headerlink" title="&#x26F3;&#xFE0F; &#x5982;&#x4F55;&#x57F7;&#x884C;"></a>&#x26F3;&#xFE0F; &#x5982;&#x4F55;&#x57F7;&#x884C;</h4><p>&#x4F7F;&#x7528; <code>fetch</code> &#x548C; <code>useQuery</code> &#x9054;&#x6210;&#x4EFB;&#x52D9;&#xFF01;</p>
<p>&#x63A5;&#x8457;&#x6211;&#x5011;&#x5C31;&#x958B;&#x59CB;&#x5427;&#xFF0C;&#x9996;&#x5148;&#xFF0C;useQuery &#x4F7F;&#x7528;&#x4E0A;&#x7684;&#x53C3;&#x6578;&#x6709;&#x5169;&#x500B;&#xFF1A;</p>
<blockquote>
<ul>
<li>A <strong>unique key for the query</strong></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>An <strong>asynchronous function (or similar then-able)</strong> to resolve the data</li>
</ul>
</blockquote>
<p>&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x5FC5;&#x9808;&#x662F;&#x4E00;&#x500B; unique &#x7684; key&#xFF0C;&#x9019;&#x500B; key &#x53EF;&#x4EE5;&#x662F;&#x5B57;&#x4E32;&#x3001;&#x9663;&#x5217;&#x3001;&#x6216;&#x662F;&#x7269;&#x4EF6;&#xFF0C;&#x9019;&#x908A;&#x70BA;&#x4E86;&#x7C21;&#x55AE;&#x8D77;&#x898B;&#xFF0C;&#x5C31;&#x5148;&#x96A8;&#x4FBF;&#x7528;&#x500B;&#x5B57;&#x4E32; <code>planets</code>&#xFF1B;&#x7B2C;&#x4E8C;&#x500B;&#x53C3;&#x6578;&#x5247;&#x662F; fetch data &#x6642;&#x6703;&#x7528;&#x5230;&#x7684;&#x975E;&#x540C;&#x6B65; function&#xFF0C;&#x9019;&#x500B; function &#x5C31;&#x662F;&#x5E73;&#x5E38;&#x4F60;&#x5728; fetch data &#x6642;&#x6703;&#x5BEB;&#x7684; function&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5011;&#x5C31;&#x5148;&#x5BEB;&#x6210;&#x9019;&#x6A23;&#xFF1A;</p>
<p></p><figure class="highlight jsx hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> { useQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react-query&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> fetchPlanets = <span class="hljs-keyword">async</span> () =&gt; {</span><br><span class="line">  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">&apos;https://swapi.dev/api/planets/&apos;</span>)</span><br><span class="line">  <span class="hljs-keyword">return</span> res.json()</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Planets</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">  <span class="hljs-keyword">const</span> { data, status, isLoading, isError, isSuccess } = useQuery(</span><br><span class="line">    <span class="hljs-string">&apos;planets&apos;</span>,</span><br><span class="line">    fetchPlanets</span><br><span class="line">  )</span><br><span class="line">  <span class="hljs-built_in">console</span>.log({ data, status, isLoading, isError })</span><br><span class="line">  <span class="hljs-keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;Planets&lt;<span class="hljs-regexp">/h2&gt;</span></span><br><span class="line"><span class="hljs-regexp">    &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5F88;&#x7C21;&#x55AE;&#xFF0C;&#x5C31;&#x662F;&#x5148;&#x5BEB;&#x500B; asynchronous function&#xFF0C;&#x7136;&#x5F8C;&#x628A; asynchronous function &#x7576;&#x4F5C;&#x53C3;&#x6578;&#x50B3;&#x5165;&#x9019;&#x6A23;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x4F86;&#xFF0C;&#x8B1B;&#x89E3;&#x4E00;&#x4E0B; useQuery &#x57F7;&#x884C;&#x5F8C;&#x6703;&#x56DE;&#x50B3;&#x7684;&#x5167;&#x5BB9;&#xFF1A;</p>
<blockquote>
<p>data&#xFF1A;&#x5C31;&#x662F; fetch &#x5F8C;&#x6703;&#x5F97;&#x5230;&#x7684; response</p>
<p>status&#xFF1A;&#x5206;&#x6210;&#x4E09;&#x500B;&#x985E;&#x578B;&#x7684;&#x5B57;&#x4E32;&#xFF0C;<code>loading</code>&#x3001;<code>success</code>&#x3001;<code>error</code>&#xFF0C;&#x5C31;&#x662F;&#x4E00;&#x822C;&#x6211;&#x5011;&#x5728; fetch &#x6642;&#x6703;&#x6709;&#x7684;&#x4E09;&#x7A2E;&#x72C0;&#x614B;</p>
<p>isLoading&#x3001;isSuccess&#x3001;isError&#xFF1A;&#x5982;&#x679C;&#x4E0D;&#x559C;&#x6B61; status &#x7684;&#x7528;&#x6CD5;&#x7684;&#x8A71;&#xFF0C;&#x53EF;&#x4EE5;&#x6539;&#x7528;&#x9019;&#x4E9B; flag</p>
</blockquote>
<p>&#x56E0;&#x70BA;&#x6211;&#x6BD4;&#x8F03;&#x7FD2;&#x6163; <code>isXXX</code> &#x9019;&#x985E;&#x7684; flag &#x7528;&#x6CD5;&#xFF0C;&#x5728;&#x5F97;&#x5230; data &#x4E4B;&#x5F8C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x5BEB;&#x6210;&#x9019;&#x6A23;&#xFF1A;</p>
<p></p><figure class="highlight jsx hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> { useQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react-query&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> Planet <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./Planet&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> fetchPlanets = <span class="hljs-keyword">async</span> () =&gt; {</span><br><span class="line">  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">&apos;https://swapi.dev/api/planets/&apos;</span>)</span><br><span class="line">  <span class="hljs-keyword">return</span> res.json()</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Planets</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">  <span class="hljs-keyword">const</span> { data, isLoading, isError, isSuccess } = useQuery(</span><br><span class="line">    <span class="hljs-string">&apos;planets&apos;</span>,</span><br><span class="line">    fetchPlanets</span><br><span class="line">  )</span><br><span class="line">  <span class="hljs-keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;Planets&lt;<span class="hljs-regexp">/h2&gt;</span></span><br><span class="line"><span class="hljs-regexp">      {isLoading &amp;&amp; &lt;div&gt;Loading...&lt;/</span>div&gt;}</span><br><span class="line">      {isError &amp;&amp; <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Fetching error<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>}</span><br><span class="line">      {isSuccess &amp;&amp;</span><br><span class="line">        data.results.map(<span class="hljs-function">(<span class="hljs-params">planet</span>) =&gt;</span> {</span><br><span class="line">          <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Planet</span> <span class="hljs-attr">planet</span>=<span class="hljs-string">{planet}</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{planet.name}</span> /&gt;</span></span></span><br><span class="line">        })}</span><br><span class="line">    &lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">  )</span></span><br><span class="line"><span class="hljs-regexp">}</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5679;&#x5577;&#xFF01;&#x4EFB;&#x52D9;&#x76EE;&#x6A19;&#x7C21;&#x6F54;&#x4E14;&#x512A;&#x96C5;&#x5730;&#x5B8C;&#x6210;&#x4E86;&#xFF01;&#x9019;&#x908A;&#x65B0;&#x589E;&#x7684; Planet Component &#x5167;&#x5BB9;&#x9577;&#x9019;&#x6A23;&#xFF1A;</p>
<p></p><figure class="highlight jsx hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Planet</span>(<span class="hljs-params">{ planet }</span>) </span>{</span><br><span class="line">  <span class="hljs-keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="hljs-string">&quot;card&quot;</span>&gt;</span><br><span class="line">      &lt;h4&gt;{planet.name}&lt;<span class="hljs-regexp">/h4&gt;</span></span><br><span class="line"><span class="hljs-regexp">      &lt;p&gt;population: {planet.population}&lt;/</span>p&gt;</span><br><span class="line">      &lt;p&gt;terrain : {planet.terrain}&lt;<span class="hljs-regexp">/p&gt;</span></span><br><span class="line"><span class="hljs-regexp">    &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x518D;&#x7A0D;&#x5FAE;&#x8ABF;&#x6574; css &#x5F8C;&#x756B;&#x9762;&#x6703;&#x9019;&#x6A23;&#xFF1A;</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gift4o0wk1j31m00u078k.jpg" alt="&#x622A;&#x5716; 2020-09-05 &#x4E0B;&#x5348;3.29.43"></p>
<p>&#x756B;&#x9762;&#x5F88;&#x919C;&#x6211;&#x77E5;&#x9053;&#xFF0C;&#x4F46;&#x6211;&#x76E1;&#x529B;&#x4E86;&#xFF0C;&#x7136;&#x5F8C; <code>People.jsx</code> &#x8981;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#x662F;&#x5DEE;&#x4E0D;&#x591A;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x4E0D;&#x591A;&#x8D05;&#x8FF0;&#xFF0C;&#x9019;&#x662F;&#x5B8C;&#x6210;&#x5F8C;&#x7684; <a href="https://codesandbox.io/s/blissful-poincare-vxqv8?file=/src/App.js" target="_blank" rel="noopener">codesandbox</a>&#x3002;</p>
<h4 id="&#x6240;&#x4EE5;&#x2026;&#x548C;-useFetch-Hook-&#x5DEE;&#x5728;&#x54EA;&#x5462;&#xFF1F;"><a href="#&#x6240;&#x4EE5;&#x2026;&#x548C;-useFetch-Hook-&#x5DEE;&#x5728;&#x54EA;&#x5462;&#xFF1F;" class="headerlink" title="&#x6240;&#x4EE5;&#x2026;&#x548C; useFetch Hook &#x5DEE;&#x5728;&#x54EA;&#x5462;&#xFF1F;"></a>&#x6240;&#x4EE5;&#x2026;&#x548C; useFetch Hook &#x5DEE;&#x5728;&#x54EA;&#x5462;&#xFF1F;</h4><p>&#x73FE;&#x5728; React Hook &#x4E5F;&#x6709;&#x4EBA;&#x4F5C;&#x51FA;&#x4E86;&#x5404;&#x7A2E; fetch data &#x76F8;&#x95DC;&#x7684; custom hook&#xFF0C;<code>useQuery</code> &#x7528;&#x8D77;&#x4F86;&#x5176;&#x5BE6;&#x5927;&#x540C;&#x5C0F;&#x7570;&#xFF0C;&#x4F46;&#x6700;&#x5927;&#x7684;&#x5DEE;&#x5225;&#x662F;&#x5728;&#x65BC;&#x5B83;&#x80CC;&#x5F8C;&#x5E6B;&#x4F60;&#x8655;&#x7406;&#x4E86; cache&#x3001;deduping&#x3001;updating  out of date data in the background &#x7B49;&#x5404;&#x7A2E;&#x4E8B;&#x60C5;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x4F60;&#x6703;&#x767C;&#x73FE;&#x5230;&#x7B2C;&#x4E00;&#x6B21; fetch &#x7684;&#x6642;&#x5019;&#x6703;&#x986F;&#x793A;&#x77ED;&#x66AB;&#x7684; loading &#x756B;&#x9762;&#xFF0C;&#x4F46;&#x4E4B;&#x5F8C;&#x5728;&#x300C;Planet&#x300D;&#x548C;&#x300C;People&#x300D;&#x5207;&#x63DB;&#x5C31;&#x9806;&#x66A2;&#x7121;&#x6BD4;&#xFF0C;&#x56E0;&#x70BA; data &#x90FD;&#x5F9E; cached &#x4E2D;&#x53D6;&#x5F97;&#x3002;</p>
<h3 id="React-Query-DevTool"><a href="#React-Query-DevTool" class="headerlink" title="React Query DevTool"></a>React Query DevTool</h3><p>React Query &#x9084;&#x6709;&#x8CBC;&#x5FC3;&#x7684;&#x63D0;&#x4F9B; Devtool &#x63D0;&#x4F9B;&#x958B;&#x767C;&#x8005;&#x8A73;&#x7D30;&#x7684;&#x6AA2;&#x8996;&#x6BCF;&#x500B; query &#x57F7;&#x884C;&#x7684;&#x72C0;&#x614B;&#xFF0C;&#x4F7F;&#x7528;&#x4E0A;&#x4E5F;&#x5F88;&#x7C21;&#x55AE;&#xFF0C;&#x9996;&#x5148;&#x5B89;&#x88DD; react query devtools</p>
<p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-query-devtools</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>  &#x63A5;&#x4E0B;&#x4F86;&#x5728; App.jsx import &#x9032;&#x4F86;&#xFF1A;</p>
<p></p><figure class="highlight jsx hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> { ReactQueryDevtools } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react-query-devtools&apos;</span> <span class="hljs-comment">// &#x9019;&#x884C;</span></span><br><span class="line"><span class="hljs-keyword">import</span> Navbar <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./components/Navbar&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> Planets <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./components/Planets&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> People <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./components/People&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">&apos;./App.css&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">  <span class="hljs-keyword">const</span> [page, setPage] = useState(<span class="hljs-string">&apos;planets&apos;</span>)</span><br><span class="line">  <span class="hljs-keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="hljs-string">&quot;App&quot;</span>&gt;</span><br><span class="line">      &lt;h1 className=<span class="hljs-string">&quot;title&quot;</span>&gt;Star Wars Info&lt;<span class="hljs-regexp">/h1&gt;</span></span><br><span class="line"><span class="hljs-regexp">      &lt;Navbar setPage={setPage} /</span>&gt;</span><br><span class="line">      &lt;div className=<span class="hljs-string">&quot;content&quot;</span>&gt;</span><br><span class="line">        {page === <span class="hljs-string">&apos;planets&apos;</span> ? <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Planets</span> /&gt;</span></span> : <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">People</span> /&gt;</span></span>}</span><br><span class="line">      &lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">      &lt;ReactQueryDevtools initialIsOpen={false} /</span>&gt; <span class="hljs-comment">// &#x4EE5;&#x53CA;&#x9019;&#x884C;&#xFF0C;initialIsOpen &#x5C31;&#x662F;&#x8A2D;&#x5B9A;&#x662F;&#x5426;&#x9810;&#x8A2D;&#x70BA;&#x6253;&#x958B;&#x7684;&#x72C0;&#x614B;</span></span><br><span class="line">    &lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">  )</span></span><br><span class="line"><span class="hljs-regexp">}</span></span><br><span class="line"><span class="hljs-regexp"></span></span><br><span class="line"><span class="hljs-regexp">export default App</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6253;&#x958B;&#x76EE;&#x524D; localhost &#x7684;&#x9801;&#x9762;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4E0B;&#x9762;&#x7684;&#x756B;&#x9762;&#xFF1A;</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giha9kf5brj31gi0u0tgv.jpg" alt="&#x622A;&#x5716; 2020-09-06 &#x4E0B;&#x5348;10.07.38"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5B83;&#x63D0;&#x4F9B;&#x4E86; Data&#x3001;Query &#x7684;&#x8A73;&#x7D30;&#x8A2D;&#x5B9A;&#x3001;&#x76EE;&#x524D; Data &#x662F; fresh&#x3001;fetching&#x3001;inactive &#x7B49;&#x7B49;&#xFF0C;&#x5982;&#x679C;&#x767C;&#x9001;&#x4E86;&#x4E0D;&#x540C;&#x7684; query&#xFF0C;&#x4E5F;&#x6703;&#x986F;&#x793A;&#x6BCF;&#x500B; query &#x7684;&#x72C0;&#x614B;&#xFF1A;</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gihabcdeeej31gi0u0gtl.jpg" alt="&#x622A;&#x5716; 2020-09-06 &#x4E0B;&#x5348;10.09.06"></p>
<p>&#x7528;&#x8D77;&#x4F86;&#x883B;&#x50CF; Redux Devtools &#x7684;&#xFF01;&#x8A2D;&#x5B9A;&#x4E5F;&#x8D85;&#x7D1A;&#x7C21;&#x55AE;&#xFF0C;&#x5B89;&#x88DD;&#x5F8C; import &#x9032;&#x4F86;&#x5C31;&#x597D;&#xFF0C;&#x4ECB;&#x9762;&#x66F4;&#x662F;&#x7C21;&#x6F54;&#x76F4;&#x89C0;&#x3002;</p>
<h3 id="&#x5982;&#x679C;&#x60F3;&#x8981;&#x5206;&#x9801;&#x600E;&#x9EBC;&#x505A;&#xFF1F;usePagination&#xFF01;"><a href="#&#x5982;&#x679C;&#x60F3;&#x8981;&#x5206;&#x9801;&#x600E;&#x9EBC;&#x505A;&#xFF1F;usePagination&#xFF01;" class="headerlink" title="&#x5982;&#x679C;&#x60F3;&#x8981;&#x5206;&#x9801;&#x600E;&#x9EBC;&#x505A;&#xFF1F;usePagination&#xFF01;"></a>&#x5982;&#x679C;&#x60F3;&#x8981;&#x5206;&#x9801;&#x600E;&#x9EBC;&#x505A;&#xFF1F;usePagination&#xFF01;</h3><h4 id="key"><a href="#key" class="headerlink" title="key"></a>key</h4><p>&#x524D;&#x9762;&#x6709;&#x5F88;&#x5FEB;&#x901F;&#x7684;&#x63D0;&#x5230;&#xFF0C;key &#x53EF;&#x4EE5;&#x63D0;&#x4F9B; strings&#x3001;array&#x3001;object &#x7B49;&#x578B;&#x614B;&#xFF0C;&#x7576;&#x6211;&#x5011;&#x9047;&#x5230;&#x6BD4;&#x8F03;&#x8907;&#x96DC;&#x7684;&#x61C9;&#x7528;&#x5834;&#x666F;&#x6642;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x8A66;&#x8457;&#x7528; array &#x6216; object &#x4F86;&#x61C9;&#x4ED8;&#x9019;&#x4E9B;&#x60C5;&#x5F62;&#xFF0C;&#x4E0B;&#x9762;&#x5C31;&#x4EE5;&#x5206;&#x9801;&#x505A;&#x7BC4;&#x4F8B;&#x3002;</p>
<p></p><figure class="highlight jsx hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> { useQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react-query&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> Planet <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./Planet&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> fetchPlanets = <span class="hljs-keyword">async</span> (str, page) =&gt; {</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(page) <span class="hljs-comment">// output: 1</span></span><br><span class="line">  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">&apos;https://swapi.dev/api/planets/&apos;</span>)</span><br><span class="line">  <span class="hljs-keyword">return</span> res.json()</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Planets</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">  <span class="hljs-keyword">const</span> { data, isLoading, isError, isSuccess } = useQuery(</span><br><span class="line">    [<span class="hljs-string">&apos;planets&apos;</span>, <span class="hljs-number">1</span>], <span class="hljs-comment">// &#x50B3;&#x5165;&#x9663;&#x5217; </span></span><br><span class="line">    fetchPlanets</span><br><span class="line">  )</span><br><span class="line">  <span class="hljs-keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;Planets&lt;<span class="hljs-regexp">/h2&gt;</span></span><br><span class="line"><span class="hljs-regexp">      {isLoading &amp;&amp; &lt;div&gt;Loading...&lt;/</span>div&gt;}</span><br><span class="line">      {isError &amp;&amp; <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Fetching error<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>}</span><br><span class="line">      {isSuccess &amp;&amp;</span><br><span class="line">        data.results.map(<span class="hljs-function">(<span class="hljs-params">planet</span>) =&gt;</span> {</span><br><span class="line">          <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Planet</span> <span class="hljs-attr">planet</span>=<span class="hljs-string">{planet}</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{planet.name}</span> /&gt;</span></span></span><br><span class="line">        })}</span><br><span class="line">    &lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">  )</span></span><br><span class="line"><span class="hljs-regexp">}</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x7576;&#x6211;&#x5011;&#x628A; useQuery &#x7684;&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578; key &#x6539;&#x4EE5;&#x9663;&#x5217;&#x50B3;&#x5165;&#x6642;&#xFF0C;asynchronous function &#x7684;&#x53C3;&#x6578;&#x503C;&#x5C31;&#x6703;&#x4F9D;&#x7167;&#x9663;&#x5217;&#x7684;&#x9806;&#x5E8F;&#x50B3;&#x5165;&#x503C;&#xFF0C;&#x4EE5;&#x4E0A;&#x9762; <code>fetchPlanets</code> &#x7684;&#x4F8B;&#x5B50;&#x4F86;&#x8AAA;&#xFF0C;&#x5B83;&#x7684;&#x7B2C;&#x4E00;&#x500B; parameter &#x7684;&#x503C;&#x5C31;&#x6703;&#x662F; <code>plaents</code>&#xFF0C;&#x7B2C;&#x4E8C;&#x500B; parameter &#x5247;&#x662F; <code>page</code> &#xFF0C;&#x4E5F;&#x56E0;&#x70BA;&#x5982;&#x6B64;&#xFF0C;&#x6211;&#x5011;&#x591A;&#x4E86;&#x66F4;&#x591A;&#x5F48;&#x6027;&#x4F7F;&#x7528;&#x7684;&#x7A7A;&#x9593;&#x3002;</p>
<p>&#x8209;&#x4F8B;&#x4F86;&#x8AAA;&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x958B;&#x59CB;&#x4F5C;&#x5206;&#x9801;&#x4E86;&#xFF01;</p>
<p></p><figure class="highlight jsx hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> { useQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react-query&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> Planet <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./Planet&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> fetchPlanets = <span class="hljs-keyword">async</span> (key, page) =&gt; {</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(page)</span><br><span class="line">  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`https://swapi.dev/api/planets/?page=<span class="hljs-subst">${page}</span>`</span>) <span class="hljs-comment">// &#x65B0;&#x589E;&#x4E86; page parameter</span></span><br><span class="line">  <span class="hljs-keyword">return</span> res.json()</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Planets</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">  <span class="hljs-keyword">const</span> [page, setPage] = useState(<span class="hljs-number">1</span>) <span class="hljs-comment">// &#x65B0;&#x589E; page state</span></span><br><span class="line">  <span class="hljs-keyword">const</span> { data, isLoading, isError, isSuccess } = useQuery(</span><br><span class="line">    [<span class="hljs-string">&apos;planets&apos;</span>, page], </span><br><span class="line">    fetchPlanets</span><br><span class="line">  )</span><br><span class="line">  <span class="hljs-keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;Planets&lt;<span class="hljs-regexp">/h2&gt;</span></span><br><span class="line"><span class="hljs-regexp">      &lt;button onClick={() =&gt; setPage(1)}&gt;page 1&lt;/</span>button&gt; <span class="hljs-comment">// &#x589E;&#x52A0;&#x4E00;&#x5806; button &#x6539;&#x8B8A; page</span></span><br><span class="line">      &lt;button onClick={() =&gt; setPage(<span class="hljs-number">2</span>)}&gt;page <span class="hljs-number">2</span>&lt;<span class="hljs-regexp">/button&gt;</span></span><br><span class="line"><span class="hljs-regexp">      &lt;button onClick={() =&gt; setPage(3)}&gt;page 3&lt;/</span>button&gt;</span><br><span class="line">      {isLoading &amp;&amp; <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>}</span><br><span class="line">      {isError &amp;&amp; <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Fetching error<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>}</span><br><span class="line">      {isSuccess &amp;&amp;</span><br><span class="line">        data.results.map(<span class="hljs-function">(<span class="hljs-params">planet</span>) =&gt;</span> {</span><br><span class="line">          <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Planet</span> <span class="hljs-attr">planet</span>=<span class="hljs-string">{planet}</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{planet.name}</span> /&gt;</span></span></span><br><span class="line">        })}</span><br><span class="line">    &lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">  )</span></span><br><span class="line"><span class="hljs-regexp">}</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x756B;&#x9762;&#x6703;&#x9577;&#x9019;&#x6A23;&#xFF1A;</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gihbw2bgddg30nw0hghdt.gif" alt="Sep-06-2020 23-04-08"></p>
<p>&#x4E0A;&#x9762;&#x505A;&#x7684;&#x6539;&#x52D5;&#x5F88;&#x7C21;&#x55AE;&#xFF0C;endpoint &#x65B0;&#x589E; page parameter&#x3001;page state &#x4EE5;&#x53CA;&#x589E;&#x52A0;&#x6539;&#x8B8A; page &#x7684; button&#xFF0C;&#x4F46;&#x554F;&#x984C;&#x4E5F;&#x5F88;&#x986F;&#x800C;&#x6613;&#x898B;&#xFF1A;</p>
<ol>
<li>&#x9019;&#x6A23;&#x65B0;&#x589E; button &#x5317;&#x4E03;&#x5317;&#x4E03;&#x7684;&#xFF08;&#x4F46;&#x9019;&#x55AE;&#x7D14;&#x662F;&#x6211;&#x61F6;&#xFF09;</li>
<li>&#x5207;&#x63DB;&#x5206;&#x9801;&#x7684;&#x6642;&#x5019;&#xFF0C;&#x6703;&#x4E0D;&#x505C;&#x986F;&#x793A; loading&#xFF0C;&#x9664;&#x975E; fetch &#x904E;&#x4E00;&#x6B21;&#xFF0C;&#x624D;&#x6703;&#x76F4;&#x63A5;&#x6293; cache &#x7684; data &#x800C;&#x4E0D;&#x986F;&#x793A; loading</li>
</ol>
<p>&#x4E0D;&#x505C;&#x5207;&#x63DB; loading &#x548C;&#x65B0;&#x9801;&#x9762;&#xFF0C;&#x96D6;&#x7136;&#x4E00;&#x822C;&#x4F86;&#x8AAA;&#x662F;&#x80FD;&#x5920;&#x5BB9;&#x5FCD;&#x7684;&#xFF0C;&#x4F46; UX &#x4F3C;&#x4E4E;&#x53EF;&#x4EE5;&#x66F4;&#x597D;&#xFF0C;&#x70BA;&#x4E86;&#x589E;&#x9032; UX&#xFF0C;&#x63A5;&#x4E0B;&#x4F86;&#x8981;&#x4F7F;&#x7528; React Query &#x63D0;&#x4F9B;&#x7684;&#x53E6;&#x4E00;&#x500B; API&#xFF0C;&#x5C31;&#x662F; usePaginatedQuery&#xFF01;</p>
<h3 id="usePaginatedQuery"><a href="#usePaginatedQuery" class="headerlink" title="usePaginatedQuery"></a>usePaginatedQuery</h3><p>&#x524D;&#x9762;&#x4F7F;&#x7528; <code>useQuery</code> &#x53EF;&#x4EE5;&#x767C;&#x73FE;&#x5230;&#x5B83;&#x904B;&#x4F5C;&#x4E0A;&#x6C92;&#x4EC0;&#x9EBC;&#x554F;&#x984C;&#xFF0C;&#x5F88;&#x591A;&#x7684; Web App &#x4E5F;&#x662F;&#x9019;&#x6A23;&#x904B;&#x4F5C;&#x7684;&#xFF0C;&#x4F46;&#x7F8E;&#x4E2D;&#x4E0D;&#x8DB3;&#x7684;&#x5730;&#x65B9;&#x662F; UI &#x6703;&#x4E00;&#x76F4;&#x5728; <code>success</code> &#x548C; <code>loading</code> &#x4E4B;&#x9593;&#x5207;&#x63DB;&#xFF0C;&#x4E0D;&#x904E;&#x5982;&#x679C;&#x4F7F;&#x7528; <code>usePaginatedQuery</code>&#xFF0C;&#x5247;&#x6709;&#x5E7E;&#x500B;&#x4E0D;&#x540C;&#x7684;&#x5730;&#x65B9;&#xFF1A;</p>
<ul>
<li><code>usePaginatedQuery</code> &#x4E0D;&#x4F7F;&#x7528; <code>data</code>&#xFF0C;&#x800C;&#x662F;&#x6539;&#x6210; <code>resolvedData</code>&#x3002;<code>resolvedData</code> &#x662F;&#x6703;&#x662F;&#x4E0A;&#x4E00;&#x6B21;&#x6210;&#x529F; fetch &#x7684; query result&#xFF0C;&#x7576;&#x4F60;&#x767C;&#x9001;&#x65B0;&#x5206;&#x9801;&#x7684; request &#x6642;&#xFF0C;<code>resolvedData</code> &#x76F4;&#x5230;&#x6210;&#x529F; fetch &#x524D;&#x90FD;&#x6703;&#x4FDD;&#x6301;&#x539F;&#x672C;&#x7684; data&#xFF0C;fetch &#x6210;&#x529F;&#x4E26;&#x62FF;&#x5230;&#x65B0;&#x7684; data &#x5F8C;&#xFF0C;<code>resolvedData</code> &#x624D;&#x6703;&#x8B8A;&#x6210;&#x6700;&#x65B0;&#x7684; data&#x3002;</li>
<li>&#x5982;&#x679C;&#x771F;&#x7684;&#x9700;&#x8981;&#x767C;&#x9001; request &#x7684;&#x7576;&#x4E0B;&#x5C31;&#x8981;&#x62FF;&#x5230; data&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>latestData</code> &#xFF0C;&#x7576;&#x4F60;&#x767C;&#x9001; request &#x5230;&#x88AB; resolved &#x524D;&#xFF0C;<code>latestData</code> &#x6703;&#x662F; <code>undefined</code> &#x76F4;&#x5230; query resolved&#xFF0C;&#x6240;&#x4EE5;&#x904B;&#x4F5C;&#x65B9;&#x5F0F;&#x5C31;&#x883B;&#x50CF;&#x539F;&#x672C; <code>useQuery</code> &#x7684; <code>data</code>&#x3002;</li>
</ul>
<p>&#x6240;&#x4EE5;&#x6211;&#x5011;&#x628A;&#x539F;&#x672C; code &#x6539;&#x52D5;&#x4E00;&#x4E0B;&#xFF1A;</p>
<p></p><figure class="highlight jsx hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> React, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> { usePaginatedQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react-query&apos;</span></span><br><span class="line"><span class="hljs-keyword">import</span> Planet <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./Planet&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> fetchPlanets = <span class="hljs-keyword">async</span> (key, page) =&gt; {</span><br><span class="line">  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`https://swapi.dev/api/planets/?page=<span class="hljs-subst">${page}</span>`</span>)</span><br><span class="line">  <span class="hljs-keyword">return</span> res.json()</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Planets</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">  <span class="hljs-keyword">const</span> [page, setPage] = useState(<span class="hljs-number">1</span>)</span><br><span class="line">  <span class="hljs-keyword">const</span> {</span><br><span class="line">    resolvedData,</span><br><span class="line">    latestData,</span><br><span class="line">    isLoading,</span><br><span class="line">    isError,</span><br><span class="line">    isSuccess,</span><br><span class="line">  } = usePaginatedQuery([<span class="hljs-string">&apos;planets&apos;</span>, page], fetchPlanets) <span class="hljs-comment">// &#x5F9E; useQuery &#x6539;&#x6210;&#x4F7F;&#x7528; usePaginatedQuery</span></span><br><span class="line">  <span class="hljs-keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h2&gt;Planets&lt;<span class="hljs-regexp">/h2&gt;</span></span><br><span class="line"><span class="hljs-regexp">      &lt;button onClick={() =&gt; setPage((prevPage) =&gt; Math.max(prevPage - 1, 1))}&gt; /</span><span class="hljs-regexp">/ &#x4FEE;&#x6539;&#x4E00;&#x4E0B; button</span></span><br><span class="line"><span class="hljs-regexp">        Previous Page</span></span><br><span class="line"><span class="hljs-regexp">      &lt;/</span>button&gt;</span><br><span class="line">      &lt;div&gt;{page}&lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">      &lt;button</span></span><br><span class="line"><span class="hljs-regexp">        onClick={() =&gt;</span></span><br><span class="line"><span class="hljs-regexp">          setPage((prevPage) =&gt;</span></span><br><span class="line"><span class="hljs-regexp">            !latestData || !latestData.next ? prevPage : prevPage + 1</span></span><br><span class="line"><span class="hljs-regexp">          )</span></span><br><span class="line"><span class="hljs-regexp">        }</span></span><br><span class="line"><span class="hljs-regexp">      &gt;</span></span><br><span class="line"><span class="hljs-regexp">        Next Page</span></span><br><span class="line"><span class="hljs-regexp">      &lt;/</span>button&gt;</span><br><span class="line">      {isLoading &amp;&amp; <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>}</span><br><span class="line">      {isError &amp;&amp; <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Fetching error<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>}</span><br><span class="line">      {isSuccess &amp;&amp;</span><br><span class="line">        resolvedData.results.map(<span class="hljs-function">(<span class="hljs-params">planet</span>) =&gt;</span> {</span><br><span class="line">          <span class="hljs-keyword">return</span> <span class="hljs-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Planet</span> <span class="hljs-attr">planet</span>=<span class="hljs-string">{planet}</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{planet.name}</span> /&gt;</span></span></span><br><span class="line">        })}</span><br><span class="line">    &lt;<span class="hljs-regexp">/div&gt;</span></span><br><span class="line"><span class="hljs-regexp">  )</span></span><br><span class="line"><span class="hljs-regexp">}</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x9644;&#x8A3B;&#x4E00;&#x4E0B;&#xFF0C;&#x9019;&#x908A; Previous Page Button &#x4F7F;&#x7528; <code>Math.max</code> &#x7684;&#x76EE;&#x7684;&#x662F;&#x907F;&#x514D;&#x5728;&#x7B2C;&#x4E00;&#x9801;&#x7684;&#x6642;&#x5019;&#x6703;&#x88AB;&#x6301;&#x7E8C;&#x6263;&#x6E1B;&#x5230;&#x5C0F;&#x65BC; 1&#x3002;</p>
<p>&#x9019;&#x6642;&#x5019;&#x64CD;&#x4F5C;&#x4E0A;&#x6703;&#x8B8A;&#x5F97;&#x50CF;&#x662F;&#x9019;&#x6A23;&#xFF1A;</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gihczyiibeg30nw0hgqv5.gif" alt="Sep-06-2020 23-42-42"></p>
<p>&#x597D;&#xFF0C;&#x6539;&#x5B8C;&#x4E4B;&#x5F8C;&#x6211;&#x89BA;&#x5F97; UX &#x6709;&#x6C92;&#x6709;&#x8B8A;&#x597D;&#x5462;&#xFF1F;&#x2026;&#x6211;&#x4FDD;&#x6301;&#x61F7;&#x7591;&#x7684;&#x614B;&#x5EA6;&#xFF0C;&#x539F;&#x56E0;&#x662F;&#x539F;&#x672C; UI &#x7684;&#x78BA;&#x662F;&#x6703;&#x5728; loading &#x548C;&#x5B8C;&#x6574;&#x7684;&#x756B;&#x9762;&#x5207;&#x63DB;&#xFF08;&#x5982;&#x679C;&#x8981;&#x6709;&#x66F4;&#x597D;&#x7684; UX &#x61C9;&#x8A72;&#x6703;&#x662F;&#x7528; Skeleton&#xFF09;&#xFF1B;&#x800C;&#x6539;&#x7528; <code>usePaginatedQuery</code> &#x5F8C;&#xFF0C;&#x5728; data &#x5B8C;&#x6210;&#x524D;&#xFF0C;&#x756B;&#x9762;&#x90FD;&#x6703;&#x4FDD;&#x6301;&#x539F;&#x6A23;&#xFF0C;&#x6240;&#x4EE5;&#x4F7F;&#x7528;&#x8005;&#x4E5F;&#x53EF;&#x80FD;&#x6703;&#x61F7;&#x7591;&#x81EA;&#x5DF1;&#x7684;&#x64CD;&#x4F5C;&#x5230;&#x5E95;&#x6709;&#x6C92;&#x6709;&#x6210;&#x529F;&#xFF0C;&#x6709; loading &#x7684;&#x8A71;&#x81F3;&#x5C11;&#x9084;&#x80FD;&#x77E5;&#x9053;&#x81EA;&#x5DF1;&#x64CD;&#x4F5C;&#x6709;&#x6210;&#x529F;&#xFF0C;&#x53EA;&#x662F;&#x9700;&#x8981;&#x7B49;&#x5F85;&#x3002;</p>
<h2 id="&#x1F449;-&#x7D50;&#x8A9E;"><a href="#&#x1F449;-&#x7D50;&#x8A9E;" class="headerlink" title="&#x1F449; &#x7D50;&#x8A9E;"></a>&#x1F449; &#x7D50;&#x8A9E;</h2><p>&#x5982;&#x540C;&#x6A19;&#x984C;&#x6240;&#x8A00;&#xFF0C;&#x9019;&#x7BC7;&#x5C31;&#x662F; Tutorial&#xFF0C;&#x4ECB;&#x7D39;&#x6700;&#x57FA;&#x672C;&#x7684; API &#x548C;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#xFF0C;&#x4F46;&#x9084;&#x6709;&#x5F88;&#x591A;&#x5730;&#x65B9;&#x6C92;&#x63D0;&#x53CA;&#xFF0C;&#x6BD4;&#x5982;&#x66F4;&#x8A73;&#x7D30;&#x7684;&#x5B98;&#x65B9;&#x6587;&#x4EF6;&#x5167;&#x5BB9;&#x3001;<code>useMutation</code>&#x3001;React Query &#x7684; cache &#x600E;&#x9EBC;&#x904B;&#x4F5C;&#x7B49;&#x7B49;&#x3002;</p>
<h3 id="&#x5F85;&#x7814;&#x7A76;&#x7684;&#x554F;&#x984C;"><a href="#&#x5F85;&#x7814;&#x7A76;&#x7684;&#x554F;&#x984C;" class="headerlink" title="&#x5F85;&#x7814;&#x7A76;&#x7684;&#x554F;&#x984C;"></a>&#x5F85;&#x7814;&#x7A76;&#x7684;&#x554F;&#x984C;</h3><ul>
<li>useMuation &#x4EE5;&#x53CA;&#x5B98;&#x65B9;&#x6587;&#x4EF6;&#x66F4;&#x8A73;&#x7D30;&#x7684;&#x5167;&#x5BB9;</li>
<li>data &#x6703; cache &#x5728;&#x54EA;&#x88E1;&#xFF1F;</li>
<li>&#x5982;&#x679C;&#x8A2D;&#x5B9A;&#x4E00;&#x500B; staleTIme &#x5F8C;&#xFF0C;&#x5728;&#x904E;&#x671F;&#x4EE5;&#x524D;&#x5982;&#x679C;&#x8CC7;&#x6599;&#x66F4;&#x65B0;&#xFF0C;React Query &#x6703;&#x600E;&#x9EBC;&#x505A;&#xFF1F;</li>
<li>&#x5982;&#x679C;&#x8981;&#x5171;&#x7528;&#x4E00;&#x4EFD; data&#xFF0C;&#x53EA;&#x80FD;&#x7528; custom hook &#x55CE;&#xFF1F;&#x90A3;&#x5047;&#x5982;&#x6709; Component A &#x548C; B&#xFF0C;&#x90FD;&#x8981;&#x7528;&#x540C;&#x4E00;&#x4EFD; data&#xFF0C;&#x662F;&#x5426;&#x53EA;&#x80FD; call &#x5169;&#x6B21; API &#x5462;&#xFF1F;&#x5982;&#x679C;&#x4E0D;&#x60F3; call &#x5169;&#x6B21; API&#xFF0C;&#x90A3;&#x662F;&#x4E0D;&#x662F;&#x53EA;&#x80FD;&#x653E;&#x9032; Redux &#x6216; Context &#x7684; Global State &#x5462;&#xFF1F;</li>
</ul>
<p>&#x9019;&#x4E9B;&#x554F;&#x984C;&#x65E5;&#x5F8C;&#x5C31;&#x4F86;&#x7814;&#x7A76;&#x3002;</p>
<h2 id="&#x1F449;-Refercences"><a href="#&#x1F449;-Refercences" class="headerlink" title="&#x1F449; Refercences"></a>&#x1F449; Refercences</h2><p><a href="https://react-query.tanstack.com/docs/overview" target="_blank" rel="noopener">React Query Docs</a></p>
<p><a href="https://www.youtube.com/watch?v=x1rQ61otgtU&amp;list=PL4cUxeGkcC9jpi7Ptjl5b50p9gLjOFani&amp;index=1" target="_blank" rel="noopener">The Net Ninjia - React Query Tutorial</a></p>
</body></html>
    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/React/">#React</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Front-End/">#Front-End</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop is-hidden-mobile article-nav-prev">
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2020/06/27/VSCode-Auto-Organize-Import/">VSCode 自動刪除沒屁用 import 以及排版</a>
            
        </span>
    </div>
    
</article>


<div class="sharebox">
    
<div class="sharethis-inline-share-buttons"></div>
<script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5e4221ec7a88780012e1744e&amp;product=inline-share-buttons' async='async'></script>

</div>



<div class="comments">
    <h3 class="title is-4">Comments</h3>
    
<script>
    var disqus_config = function () {
        this.page.url = 'https://chihyang41.github.io/2020/09/07/React-Query-Tutorial/';
        this.page.identifier = '2020/09/07/React-Query-Tutorial/';
        
        this.language = 'en';
        
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'ChihYang41-blog' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
</div>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2020 Chih Yang&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" href="https://github.com/ChihYang41" target="_blank" rel="noopener">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/" target="_blank" rel="noopener">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("en-AU");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js"></script>


    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>

<script src="/js/insight.js"></script>

    
</body>
</html>